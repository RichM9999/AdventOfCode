//https://adventofcode.com/2025/day/7
namespace AdventOfCode.Year2025
{
    using Coordinate = (int x, int y);

    class Day7 : IDay
    {
        private const int mapSizeY = 142;
        private const int mapSizeX = 141;

        //Dictionary<Coordinate, (char space, long beams)> map = [];
        private Dictionary<Coordinate, (char space, long beams)> map = [];

        public void Run()
        {
            var start = DateTime.Now;

            LoadData();

            (var splits, var beams) = Part1And2();
            // 1590
            Console.WriteLine($"Part 1 answer: {splits}");
            // 20571740188555
            Console.WriteLine($"Part 2 answer: {beams}");

            Console.WriteLine($"{(DateTime.Now - start).TotalMilliseconds}ms");
        }

        private (long splits, long beams) Part1And2()
        {
            long splits = 0;

            // Analyze rows from top to bottom
            for (var y = 1; y < mapSizeY; y++)
            {
                // Analyze row left to right
                for (var x = 0; x < mapSizeX; x++)
                {
                    // If location above is start location, change to a single beam
                    if (map[(x, y - 1)].space == 'S')
                    {
                        map[(x, y - 1)] = ('|', 1);
                    }

                    // If location above is a beam...
                    if (map[(x, y - 1)].space == '|')
                    {
                        // Get count of incoming (overlapping) beams
                        var incomingBeams = map[(x, y - 1)].beams;

                        // If row space is empty or already has another pass-through beam...
                        if (map[(x, y)].space == '.' || map[(x, y)].space == '|')
                        {
                            // Change space to a beam with count of incoming beams plus count of beams already passing through space
                            map[(x, y)] = ('|', incomingBeams + map[(x, y)].beams);
                        }
                        // If row space is a splitter...
                        else if (map[(x, y)].space == '^')
                        {
                            // Mark space to left as a beam with count of incoming beams plus count of beams already passing through space
                            map[(x - 1, y)] = ('|', incomingBeams + map[(x - 1, y)].beams);
                            // Mark space to right as a beam with count of incoming beams plus count of beams already passing through space
                            map[(x + 1, y)] = ('|', incomingBeams + map[(x + 1, y)].beams);
                            // Increment split count
                            splits++;
                        }
                    }
                }
            }

            // Total number of pathways is sum of overlapping beams passing through each space on final row
            long beams = 0;

            for (var x = 0; x < mapSizeX; x++)
            {
                beams += map[(x, mapSizeY - 1)].beams;
            }

            // Return results
            return (splits, beams);
        }

        private void AddMapRow(int row, string data)
        {
            for (var x = 0; x < data.Length; x++)
            {
                var space = data[x];
                map.Add((x, row), (space, 0));
            }
        }

        private void LoadData()
        {
            AddMapRow(000, "......................................................................S......................................................................");
            AddMapRow(001, ".............................................................................................................................................");
            AddMapRow(002, "......................................................................^......................................................................");
            AddMapRow(003, ".............................................................................................................................................");
            AddMapRow(004, ".....................................................................^.^.....................................................................");
            AddMapRow(005, ".............................................................................................................................................");
            AddMapRow(006, "....................................................................^...^....................................................................");
            AddMapRow(007, ".............................................................................................................................................");
            AddMapRow(008, "...................................................................^.....^...................................................................");
            AddMapRow(009, ".............................................................................................................................................");
            AddMapRow(010, "..................................................................^...^...^..................................................................");
            AddMapRow(011, ".............................................................................................................................................");
            AddMapRow(012, ".................................................................^.^...^.^.^.................................................................");
            AddMapRow(013, ".............................................................................................................................................");
            AddMapRow(014, "................................................................^.^.......^.^................................................................");
            AddMapRow(015, ".............................................................................................................................................");
            AddMapRow(016, "...............................................................^...^...^.^.^.^...............................................................");
            AddMapRow(017, ".............................................................................................................................................");
            AddMapRow(018, "..............................................................^.^.^...^.......^..............................................................");
            AddMapRow(019, ".............................................................................................................................................");
            AddMapRow(020, ".............................................................^...^.^.^.^...^.^.^.............................................................");
            AddMapRow(021, ".............................................................................................................................................");
            AddMapRow(022, "............................................................^.^.^.^...^.......^.^............................................................");
            AddMapRow(023, ".............................................................................................................................................");
            AddMapRow(024, "...........................................................^.^.^.^.^.^.^.^.^...^.^...........................................................");
            AddMapRow(025, ".............................................................................................................................................");
            AddMapRow(026, "..........................................................^.....^.^.^.^.^.....^...^..........................................................");
            AddMapRow(027, ".............................................................................................................................................");
            AddMapRow(028, ".........................................................^.^.....^.^.^.^.^...^.^.^.^.........................................................");
            AddMapRow(029, ".............................................................................................................................................");
            AddMapRow(030, "........................................................^.^.^.^.^.^.^.^...^...^.....^........................................................");
            AddMapRow(031, ".............................................................................................................................................");
            AddMapRow(032, ".......................................................^.^.^.^.^.^.^.......^...^.....^.......................................................");
            AddMapRow(033, ".............................................................................................................................................");
            AddMapRow(034, "......................................................^.^.^.^...^.^.....^.^.^.^.^...^.^......................................................");
            AddMapRow(035, ".............................................................................................................................................");
            AddMapRow(036, ".....................................................^.^.^.^.^.^.^.....^.....^...^.^.^.^.....................................................");
            AddMapRow(037, ".............................................................................................................................................");
            AddMapRow(038, "....................................................^.^...^.^.......^.^.^.......^...^.^.^....................................................");
            AddMapRow(039, ".............................................................................................................................................");
            AddMapRow(040, "...................................................^...^.^...^...^.^.^.^.^...^...^.^.....^...................................................");
            AddMapRow(041, ".............................................................................................................................................");
            AddMapRow(042, "..................................................^.....^...^.^.^.....^...^.^...^.......^.^..................................................");
            AddMapRow(043, ".............................................................................................................................................");
            AddMapRow(044, ".................................................^.^.^.^.^.^.^.^...^.^.^.^.^.....^.^...^.^.^.................................................");
            AddMapRow(045, ".............................................................................................................................................");
            AddMapRow(046, "................................................^.^...^.^.....^.^.....^...^.^.^.....^.^...^.^................................................");
            AddMapRow(047, ".............................................................................................................................................");
            AddMapRow(048, "...............................................^.........^.^.^.^.^.^.^.^...^.^.^.^...........^...............................................");
            AddMapRow(049, ".............................................................................................................................................");
            AddMapRow(050, "..............................................^.^.......^...^...^...^...^.^.^.^.^.^.^.^.^.^.^.^..............................................");
            AddMapRow(051, ".............................................................................................................................................");
            AddMapRow(052, ".............................................^.........^.^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.............................................");
            AddMapRow(053, ".............................................................................................................................................");
            AddMapRow(054, "............................................^.^...^...^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^............................................");
            AddMapRow(055, ".............................................................................................................................................");
            AddMapRow(056, "...........................................^.^.^.^...^.^.^.^.^.^.....^.^.^.^.^.^.^...^.^.^.^.^...^...........................................");
            AddMapRow(057, ".............................................................................................................................................");
            AddMapRow(058, "..........................................^.....^.^.......^.^.^.^.^.^.^.....^.^.^.^.....^.^.^.^.^.^..........................................");
            AddMapRow(059, ".............................................................................................................................................");
            AddMapRow(060, ".........................................^.....^.^.^.^.^.^.^...^.^.^.....^.....^.^.....^.^.......^.^.........................................");
            AddMapRow(061, ".............................................................................................................................................");
            AddMapRow(062, "........................................^.^...^.^.^.^...^...^.^.^.^.^...^.^.^.^...^.....^.^.^...^...^........................................");
            AddMapRow(063, ".............................................................................................................................................");
            AddMapRow(064, ".......................................^.^.^.^.^.......^...^.^.^.^...^...^.^.^...^...^.^.^...........^.......................................");
            AddMapRow(065, ".............................................................................................................................................");
            AddMapRow(066, "......................................^.^...^.^.^.^...^...^.^.^.........^.^.^.^...^.^.^.^...^...^.....^......................................");
            AddMapRow(067, ".............................................................................................................................................");
            AddMapRow(068, ".....................................^.........^.^.^.^.^.^...^.........^.^.^.^.^.^.^.^.^...^.^.^...^...^.....................................");
            AddMapRow(069, ".............................................................................................................................................");
            AddMapRow(070, "....................................^.^.^...^.^.^.....^.^.^.^.^.....^.^.^...^...^...^.^.^.^...^...^...^.^....................................");
            AddMapRow(071, ".............................................................................................................................................");
            AddMapRow(072, "...................................^...^.^.^.^.^...^...^...^...^.^.^.^.^...^.^.^...^...^.^.^.........^.^.^...................................");
            AddMapRow(073, ".............................................................................................................................................");
            AddMapRow(074, "..................................^.^.^.^...^.^.....^.^.^.^.^...^...^.^.^.^.....^...^...^.^...^.^...^.^...^..................................");
            AddMapRow(075, ".............................................................................................................................................");
            AddMapRow(076, ".................................^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.......^...^.^.^.......^...^.^.^.^.^.^.^.^.................................");
            AddMapRow(077, ".............................................................................................................................................");
            AddMapRow(078, "................................^.^.^...^.^...^.^...^.^.^.^...^.^...^.^.^.^.....^.....^.^.^.^.^.......^...^.^................................");
            AddMapRow(079, ".............................................................................................................................................");
            AddMapRow(080, "...............................^.^.^...^.^.^...^.^.^.^.^.^.....^.^.^.^...^.^.^.^.^.^.^.....^.^.^.^.....^.....^...............................");
            AddMapRow(081, ".............................................................................................................................................");
            AddMapRow(082, "..............................^.^...^.^.^.^.^.^...^.^.^.^...^.^.^...^.^...^.^...^.^.^.^...^.^.....^.^.^.....^.^..............................");
            AddMapRow(083, ".............................................................................................................................................");
            AddMapRow(084, ".............................^.^.^.^.^...^.^.^.^.^...^...^.^.^.^.^.........^.^.^...^.^...^.^...^.^.^...^...^.^.^.............................");
            AddMapRow(085, ".............................................................................................................................................");
            AddMapRow(086, "............................^...^.^...^.^...^.^.^.^...^.^.^.^.^...^.^.......^.^.^.^...^.^...^.^.^...^.^.........^............................");
            AddMapRow(087, ".............................................................................................................................................");
            AddMapRow(088, "...........................^.^.^...^.^.^.^...^.^.^.....^.^.^.^.......^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^...^.^...........................");
            AddMapRow(089, ".............................................................................................................................................");
            AddMapRow(090, "..........................^.^...^...^.^.^...^.^.^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^...^...^.^.^.^...^.^.^.^.^...^.^..........................");
            AddMapRow(091, ".............................................................................................................................................");
            AddMapRow(092, ".........................^.^.^...^.^.^...^.^.^.^.....^.^...^...^.^...^.^.....^...^.^.^.^.^.^.^.....^.^.^.......^...^.........................");
            AddMapRow(093, ".............................................................................................................................................");
            AddMapRow(094, "........................^...^.^.^.^.^.^...^.^...^.^...^.^.........^.^.....^.^.^...........^...^.^.^.^...^.^.^.^.^.^.^........................");
            AddMapRow(095, ".............................................................................................................................................");
            AddMapRow(096, ".......................^.^.^.....^.^.^.....^.^.^.^.^.^...^.^.^...^.^.^.^.^...^.....^.^...^.^.^...^.^.^.^...^.^.^.^.^.^.......................");
            AddMapRow(097, ".............................................................................................................................................");
            AddMapRow(098, "......................^.^.^.^.^.^...^...^.^.......^...^.^...^.^...^.^.^.^.^.^.^...^.....^...^...^...^.^...^.^...^.^.^.^......................");
            AddMapRow(099, ".............................................................................................................................................");
            AddMapRow(100, ".....................^.^...^.^.^.^.^...^.^.^...^.^.^.^...^...^.^.^...^.....^.^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^...^.^.^.....................");
            AddMapRow(101, ".............................................................................................................................................");
            AddMapRow(102, "....................^...^.^.^.^.^.....^.^.^.......^.^.^.^.^.^.^.^.......^...^...^.^.....^.....^...^.^...^.^.^.^.^.^.^...^....................");
            AddMapRow(103, ".............................................................................................................................................");
            AddMapRow(104, "...................^.^...^.^.^.^.^.^.^.^.............^.........^.^.^...^...^...^.^.........^.^.....^.^...^.....^.^.^.^...^...................");
            AddMapRow(105, ".............................................................................................................................................");
            AddMapRow(106, "..................^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.....^...^.^.^.^.........^.^...^...^.^.......^.....^.^.^.....^.^...^..................");
            AddMapRow(107, ".............................................................................................................................................");
            AddMapRow(108, ".................^.^.^...^...^.^.^.^.^.^.^.^.^.^...^...^.^...^.^.^.^...^.^.^.^.^.^.^...^.^.......^.^...^.^.........^...^.^.^.................");
            AddMapRow(109, ".............................................................................................................................................");
            AddMapRow(110, "................^.^.^.....^...^.^...^.^.^.^.^.^...^.^...^.^.^.^.^.^.....^.^.^.^.^.....^...^.....^.^.^.....^.^.^.^.^...^.^...^................");
            AddMapRow(111, ".............................................................................................................................................");
            AddMapRow(112, "...............^.^.....^.^...^...^...^.^.^.......^...^.^...^.^.^...^.^.^.......^.^...^.^.^...^...^.^.....^...^...^.^.....^...^...............");
            AddMapRow(113, ".............................................................................................................................................");
            AddMapRow(114, "..............^.^.^.....^.^.^.^.^...^...^.^...^...^.^.^.....^...^.^.^.^.^...^.^.^.^.......^.^.....^...^.^...^.^.^...^.^.^...^.^..............");
            AddMapRow(115, ".............................................................................................................................................");
            AddMapRow(116, ".............^.^.^.^.^.....^.^...^.^...^...^.^.^...^.^.^...^...^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^...^...^.^.^.^...^.....^.^.............");
            AddMapRow(117, ".............................................................................................................................................");
            AddMapRow(118, "............^.^.^...^.......^.^...^.^.^.......^.^...^.^.^...^.^.^...........^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.......^.^.^.^.^.^.^.^............");
            AddMapRow(119, ".............................................................................................................................................");
            AddMapRow(120, "...........^.....^.^...^...^.^...^...^...^.^.^...^...^...^.^.^...^.....^...^...^...^.....^...^.....^.^.^...^.^.^...^.^...^.^.^.^.^...........");
            AddMapRow(121, ".............................................................................................................................................");
            AddMapRow(122, "..........^.^.^.^.^.......^.^.^.^.^.^.....^.....^.^...^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^.^.^.^...^.^.....^...^.^.^..........");
            AddMapRow(123, ".............................................................................................................................................");
            AddMapRow(124, ".........^...^.^.^...^.^.^.^.^.....^...^...^.^.^...^.^.^...^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^...^.....^.^.^.......^.^.^.^.........");
            AddMapRow(125, ".............................................................................................................................................");
            AddMapRow(126, "........^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.......^.^.^.^.^.^.^...^.^.^.....^...^.^.....^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^........");
            AddMapRow(127, ".............................................................................................................................................");
            AddMapRow(128, ".......^.^.......^.^.^.^.^.^.^...^.^.^.^.......^.....^...^.^.^.^.^.^.^.^...^.^...^...^.^.....^.^.....^...^.^.......^...^.^.^.^.^.^...^.......");
            AddMapRow(129, ".............................................................................................................................................");
            AddMapRow(130, "......^.^...^...^.^.^...^...^.^.^.^.^.^...^.^...^.....^.^.^.^.......^...^...^.^.....^.^.^.....^.^...^.^.....^.^.^.^.^.....^.....^.....^......");
            AddMapRow(131, ".............................................................................................................................................");
            AddMapRow(132, ".....^.^.^.^.....^.^.^.^.^.^.^...^.^.....^.^.^.....^.^.........^.^...^.^.....^...^.^.^.^.^.......^.^.....^.....^.^.^.^.^.^.^.....^.^...^.....");
            AddMapRow(133, ".............................................................................................................................................");
            AddMapRow(134, "....^...^.....^.^...^...^.^.^.........^.^.^.^.^.^.^.^.^.^.^.^...^.^.....^.....^.^.^.....^.^.^.^.^.^.....^.^.^.^.^...^.^.^.^...^.^.^.^...^....");
            AddMapRow(135, ".............................................................................................................................................");
            AddMapRow(136, "...^.....^.^.^.^...^.^.^.^.^.^.^...^.^.......^.^...^...^.^...^.^.^.......^.^.^.^.^.^.^.^.^...^.^.^.^...^.^.....^.^.^.^.^...^.^.^...^.^.^.^...");
            AddMapRow(137, ".............................................................................................................................................");
            AddMapRow(138, "..^.^.^.^...^.^.^.^.^...^.^.^.^.....^.^...^...^.^.^.^.....^.^.^.....^.^...^.^.^...^.^.^.........^.........................^.^.^.^.^.^...^.^..");
            AddMapRow(139, ".............................................................................................................................................");
            AddMapRow(140, ".^.^.....^.^.^.^.^.^.^...^.^.^...^.^...^.^.^.^...^.....^.^...^.^...^.^.^.^.....^...^.^...^...^.^.^.....^.^...^.^...^...^.^.^.^.^.^.^...^.^.^.");
            AddMapRow(141, ".............................................................................................................................................");
        }
    }
}
